<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZFuture Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f4f4f4;padding:15px}
h2,h3{margin-top:20px}
input,textarea,select,button{
  width:100%;padding:10px;margin-top:8px;font-size:14px
}
button{cursor:pointer}
.hidden{display:none}
.box{
  background:#fff;padding:12px;border-radius:8px;margin-top:15px
}
.product{
  border:1px solid #ddd;
  padding:10px;
  margin-top:8px;
  border-radius:6px
}
.cat-title{
  background:#222;color:#fff;
  padding:8px;border-radius:6px;
  cursor:pointer;margin-top:15px
}
.actions{display:flex;gap:10px;margin-top:8px}
.actions button{flex:1}
small{color:#555}
hr{margin:20px 0}
</style>
</head>

<body>

<h2>ZFuture – Admin Panel</h2>

<!-- LOGIN -->
<div id="loginBox" class="box">
  <h3>Admin Login</h3>
  <input id="aid" placeholder="Admin ID">
  <input id="apass" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
</div>

<!-- PANEL -->
<div id="panel" class="hidden">

<!-- ================= CATEGORY ================= -->
<div class="box">
<h3>Categories</h3>
<input id="cname" placeholder="New category">
<button onclick="addCategory()">Add Category</button>
</div>

<!-- ================= PRODUCT ================= -->
<div class="box">
<h3>Add / Edit Product</h3>

<select id="pcat"></select>

<input id="pname" placeholder="Product name">
<textarea id="pdesc" placeholder="Description"></textarea>

<input id="pprice" type="number" placeholder="Original price">
<input id="poffer" type="number" placeholder="Offer %">

<label><small>Main Image</small></label>
<input type="file" id="pimgMain" accept="image/*">

<label><small>Extra Images (up to 3)</small></label>
<input type="file" id="pimgExtra" accept="image/*" multiple>

<label><small>Return Policy</small></label>
<select id="preturn">
  <option value="no">No Return</option>
  <option value="yes">Return Available</option>
</select>
<input id="preturnDays" placeholder="Return days">

<label><small>Warranty</small></label>
<select id="pwarranty">
  <option value="no">No Warranty</option>
  <option value="yes">Warranty Available</option>
</select>
<input id="pwarrantyTime" placeholder="Warranty time (eg: 6 Months)">

<button onclick="saveProduct()">Save Product</button>
</div>

<!-- ================= SLIDER ================= -->
<div class="box">
<h3>Home Slider (Poster only – Max 6)</h3>
<input type="file" id="slideImg" accept="image/*">
<input id="slideTitle" placeholder="Title text">
<button onclick="addSlide()">Add Slide</button>
<div id="slideList"></div>
</div>

<!-- ================= PRODUCT LIST ================= -->
<div class="box">
<h3>Products (Category-wise)</h3>
<div id="productList"></div>
</div>

</div>

<script>
  if(localStorage.getItem("adminLogged")!=="yes"){
  window.location.href="admin-login.html";
}
const ADMIN_ID="admin";
const ADMIN_PASS="1234";

let categories = JSON.parse(localStorage.getItem("categories")||"[]");
let products   = JSON.parse(localStorage.getItem("products")||"[]");
let slides     = JSON.parse(localStorage.getItem("homeSlides")||"[]");

let editIndex = -1;

/* LOGIN */
function login(){
  if(aid.value===ADMIN_ID && apass.value===ADMIN_PASS){
    loginBox.classList.add("hidden");
    panel.classList.remove("hidden");
    syncCat();
    renderProducts();
    renderSlides();
  } else alert("Wrong login");
}

/* CATEGORY */
function addCategory(){
  if(cname.value && !categories.includes(cname.value)){
    categories.push(cname.value);
    localStorage.setItem("categories",JSON.stringify(categories));
    cname.value="";
    syncCat();
    renderProducts();
  }
}
function syncCat(){
  pcat.innerHTML="";
  categories.forEach(c=>pcat.innerHTML+=`<option>${c}</option>`);
}

/* PRODUCT SAVE */
function saveProduct(){
  let price = Number(pprice.value);
  let offer = Number(poffer.value)||0;
  let finalPrice = Math.round(price-(price*offer/100));

  let data={
    id: editIndex>-1 ? products[editIndex].id : Date.now(),
    name:pname.value,
    desc:pdesc.value,
    price,offer,finalPrice,
    category:pcat.value,
    return:preturn.value,
    returnDays:preturnDays.value,
    warranty:pwarranty.value,
    warrantyTime:pwarrantyTime.value,
    images:[]
  };

  let files=[...pimgExtra.files];
  if(pimgMain.files[0]) files.unshift(pimgMain.files[0]);

  if(files.length){
    let done=0;
    files.forEach(f=>{
      let r=new FileReader();
      r.onload=e=>{
        data.images.push(e.target.result);
        done++;
        if(done===files.length) finishSave(data);
      };
      r.readAsDataURL(f);
    });
  }else{
    if(editIndex>-1) data.images=products[editIndex].images;
    finishSave(data);
  }
}

function finishSave(data){
  if(editIndex>-1){
    products[editIndex]=data;
    editIndex=-1;
  }else{
    products.push(data);
  }
  localStorage.setItem("products",JSON.stringify(products));
  clearForm();
  renderProducts();
}

function clearForm(){
  pname.value=pdesc.value=pprice.value=poffer.value="";
  preturnDays.value=pwarrantyTime.value="";
  pimgMain.value=pimgExtra.value="";
}

/* PRODUCT LIST */
function renderProducts(){
  productList.innerHTML="";
  categories.forEach(cat=>{
    let div=document.createElement("div");
    div.innerHTML=`<div class="cat-title" onclick="this.nextElementSibling.classList.toggle('hidden')">${cat}</div>`;
    let box=document.createElement("div");
    products.filter(p=>p.category===cat).forEach((p,i)=>{
      box.innerHTML+=`
        <div class="product">
          <b>${p.name}</b><br>
          ₹${p.finalPrice} (${p.offer}% OFF)<br>
          <small>Return: ${p.return} | Warranty: ${p.warranty}</small>
          <div class="actions">
            <button onclick="edit(${i})">Edit</button>
            <button onclick="del(${i})">Delete</button>
          </div>
        </div>`;
    });
    div.appendChild(box);
    productList.appendChild(div);
  });
}

function edit(i){
  let p=products[i];
  pname.value=p.name;
  pdesc.value=p.desc;
  pprice.value=p.price;
  poffer.value=p.offer;
  pcat.value=p.category;
  preturn.value=p.return;
  preturnDays.value=p.returnDays;
  pwarranty.value=p.warranty;
  pwarrantyTime.value=p.warrantyTime;
  editIndex=i;
}

function del(i){
  if(confirm("Delete product?")){
    products.splice(i,1);
    localStorage.setItem("products",JSON.stringify(products));
    renderProducts();
  }
}

/* SLIDER */
function addSlide(){
  if(slides.length>=6) return alert("Max 6 slides allowed");
  let f=slideImg.files[0];
  if(!f) return alert("Select image");
  let r=new FileReader();
  r.onload=e=>{
    slides.push({img:e.target.result,title:slideTitle.value});
    localStorage.setItem("homeSlides",JSON.stringify(slides));
    slideImg.value=slideTitle.value="";
    renderSlides();
  };
  r.readAsDataURL(f);
}
function renderSlides(){
  slideList.innerHTML="";
  slides.forEach((s,i)=>{
    slideList.innerHTML+=`
      <div class="product">
        ${s.title || "Slide"}
        <button onclick="delSlide(${i})">Delete</button>
      </div>`;
  });
}
function delSlide(i){
  if(confirm("Delete slide?")){
    slides.splice(i,1);
    localStorage.setItem("homeSlides",JSON.stringify(slides));
    renderSlides();
  }
}
</script>

</body>
</html>
